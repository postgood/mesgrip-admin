var t=Object.defineProperty,e=Object.getOwnPropertyNames,o=(e,o,n)=>(((e,o,n)=>{o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n})(e,"symbol"!=typeof o?o+"":o,n),n);import{U as n,A as s,C as i}from"./AjaxCall-C-4S7g8x.js";import"./crypto-js-kLIhi_3x.js";import"./jquery-Dvpmrn5Q.js";import"./sweetalert2-Dkd8NR4e.js";var l,r,a=(l={"assets/workReport-D--8BkaE.js"(t){let e=class{constructor(t,e,i){o(this,"init",(()=>{this.signinInit()})),o(this,"signinInit",(()=>{let t=this;if(null!=localStorage&&localStorage.getItem("userIdSave")){let t=localStorage.getItem("userid");$("input[name=userid]").val(t),$(".imgChkBoxLabel").trigger("click")}let e=window.innerWidth||document.body.clientWidth,o=$(".logBox").width();e!=parseInt(o)&&$(".logBox").css("left","50%").css("margin-left","-250px");let n={ctl:"company",cmd:"info"};n.host=document.location.host,new s(t._const,n).ajaxformdata((function(e){if(0==e.code){let o=e.data;$(".logLogo").empty(),$(".copy").empty(),$(".logLogo").append('<img src="https://kprintfactory.s3.ap-northeast-2.amazonaws.com'+o.fileInfo[0].path.replace("kprintfactory/","")+'" alt="" style="filter:invert(93%);">'),$(".copy").append("<b>"+o.cNm+'</b> <i class="fa-solid fa-square-phone-flip"></i> '+(t._utils.checkEmptyNull(o.cTel)?"":t._utils.formatPhoneNumber(o.cTel))+' <i class="fa-solid fa-location-arrow"></i> : '+o.cAddr+" "+o.cAddrDetail);let n=location.href;console.log("url="+n);let i='<div style="height:50px;margin-top:50px;">작업지시서의 QR코드를 통하여 진입하시기 바랍니다.</div>',l={};if(!(n.indexOf("?")>-1))return alert($(i).text()),$("#login-form").empty(),void $("#login-form").append(i);if(n.indexOf(document.location.host)>-1||n.indexOf("127.0.0.1")>-1){let e,r=n.substring(n.indexOf("?")+1);console.log("parameter="+r),sessionStorage.setItem("parameter",r);let a=r.split("&");for(let t=0;t<a.length;t++){let e=a[t].substring(0,a[t].indexOf("=")),o=a[t].substring(a[t].indexOf("=")+1);console.log("v="+o),l[e]=o}if(null==l.p)return $("#login-form").empty(),void $("#login-form").append(i);{$("input[name=p]").val(l.p);let n={},r=t._utils.decryptData(decodeURI(l.p)).split("&");for(let t=0;t<r.length;t++){let e=r[t].split("=");n[e[0]]=e[1]}if(null!=n.oSeq){e=n.oSeq;let i={ctl:"order",cmd:"loadCheck",cSeq:o.cSeq,oSeq:e};new s(t._const,i).ajaxformdata((function(t){if(0==t.code){let e=t.data;"Y"!=e.oApprovalYn&&(alert("작업 승인되지 않은 수주건 입니다."),$("#login-form").empty(),$("#login-form").append("")),"C"==e.oStatus&&(alert("완료된 수주건 입니다."),$("#login-form").empty(),$("#login-form").append(""))}else alert(t.message)}))}else $("#login-form").empty(),$("#login-form").append(i)}}else $("#login-form").empty(),$("#login-form").append(i)}else alert(e.message)})),$("#btnSingin").on("click",(function(){t._utils.checkRequired("#login-form")&&($(".imgChkBoxLabel").hasClass("lbOn")?(localStorage.setItem("userid",$("input[name=userid]").val()),localStorage.setItem("userIdSave",!0)):(localStorage.removeItem("userid"),localStorage.removeItem("userIdSave")),$("form").trigger("submit"))})),$("input[name=encpwd]").on("keypress",(function(t){if(t.keyCode&&13==t.keyCode)return $("#btnSingin").trigger("click"),!1}))})),this._const=t||{},this._data=e||{},this._param=i||{},this._options={},this._utils=new n,this._ajax=new s}},l=class{constructor(t,e,i){o(this,"init",((t,e)=>{const o=this;o._id=t,o._data=e||{};let n=$("#mobileContainerWorkReport"),i=$(".workReportBoard"),l=$(".workInfoTable",i).clone();i.empty();let r=sessionStorage.getItem("parameter"),a=r.split("&"),c={};for(let s=0;s<a.length;s++){let t=a[s].substring(0,a[s].indexOf("=")),e=a[s].substring(a[s].indexOf("=")+1);c[t]=e}if(null!=c.p){{let t={},e=o._utils.decryptData(decodeURI(c.p)).split("&");for(let o=0;o<e.length;o++){let n=e[o].split("=");t[n[0]]=n[1]}if(null!=t.oSeq){let e={ctl:"outsourcing",cmd:"orderDataLoad",oSeq:t.oSeq};new s(o._const,e).ajaxformdata((function(t){if(0==t.code){let e=t.data;if(null==e.workInfo||0==e.workInfo.length)return alert("발주된 작업 내용이 존재하지 않습니다."),void setTimeout((function(){location.href="/workreport?p="+r}),4e3);if("Y"!=e.oApprovalYn)return alert("승인되지 않은 수주건 입니다."),void setTimeout((function(){location.href=e.cHompage}),3e3);if("C"==e.oStatus)return alert("완료된 수주건 입니다."),void setTimeout((function(){location.href=e.cHompage}),3e3);if(o._utils.classNameInput(n,e),$(".cTel",n).text(o._utils.formatPhoneNumber(e.cTel)),!o._utils.checkEmptyNull(e.osInMemo)){let t=$(".osInNm",n).attr("style");t+="font-size:12px;",$(".osInNm",n).text(e.osInNm+" ("+e.osInMemo+")"),$($(".osInNm",n)).attr("style",t)}if(!o._utils.checkEmptyNull(e.osOutMemo)){let t=$(".osOutNm",n).attr("style");t+="font-size:12px;",$(".osOutNm",n).text(e.osOutNm+" ("+e.osOutMemo+")"),$($(".osOutNm",n)).attr("style",t)}let s="";e.processInfo.sort(((t,e)=>t.sort<e.sort?-1:t.sort>e.sort?1:0));for(let t=0;t<e.processInfo.length;t++){let o=e.processInfo[t];s+='<span class="mprocessStatus'+o.pStatus+'" >'+o.spNm+"</span>"}$(".processFlow",n).empty().append(s);let a=e.workInfo;for(let t=0;t<a.length;t++){let e=l.clone(),n=$("thead tr",l).clone(),s=$("tbody tr:eq(0)",l).clone(),r=$("tbody tr:eq(1)",l).clone(),c=$("tbody tr:eq(2)",l).clone();$("thead",e).empty(),$("tbody",e).empty();let p=n.clone(),d=s.clone(),u=r.clone(),m=c.clone(),f=a[t];o._utils.classNameInput(p,f),o._utils.checkEmptyNull(f.wInfo)||$(".wNm",p).text(f.wNm+"("+f.wInfo+")"),o._utils.checkEmptyNull(f.oswMemo)||$(".oswMemo",p).text("※ "+f.oswMemo),"D"==f.oswStatus?(p.children().css("background","#999"),$(".wNm",p).css("border-right","1px solid #777 !important"),$(".workCheck",p).css("color","#fff !important")):"B"==f.oswStatus&&p.children().css("background","#4e80ee"),$("thead",e).append(p),o._utils.classNameInput(d,f);let h=0,g=f.optionInfo.length>0?f.optionInfo:f.optionInfoOrg;for(let t=0;t<g.length;t++)if("Y"==g[t].cwoOrderYn){let n=null!=g[t].oswoInput?g[t].oswoInput:g[t].woInput;if(!o._utils.checkEmptyNull(n)){let o=g[t].cwoNm+" : "+n;0==h?($(".wOption",d).append(o),$("tbody",e).append(d)):(u=r.clone(),$(".wOption",u).append(o),$(".wOption",u).css({"border-bottom":"1px solid #a3a3a3"}),$("tbody",e).append(u)),h++}}0==h?($(".wFrontYnNm, .oswCnt",d).removeAttr("rowspan"),$(".wOption",d).append("&nbsp;").css({"border-bottom":"2px solid #a3a3a3"}),$("tbody",e).append(d)):($(".wOption",u).css({"border-bottom":"2px solid #a3a3a3"}),$(".wFrontYnNm, .oswCnt",d).attr("rowspan",h));let _="진행";"B"==f.oswStatus&&(_="완료"),"D"==f.oswStatus?($(".btnAction",m).attr("style","border:0px;text-align: left;padding-left: 120px;"),_="완료일시 : <strong>"+f.oswStatusDate.substring(0,16)+"</strong>",_+="<br>완료수량 : <strong>"+o._utils.numberWithCommas(f.oswEndCnt)+"</strong>",$(".btnAction",m).empty().append(_)):$(".btnAction",m).text(_),$("tbody",e).append(m),e.data("ROW",f),i.append(e)}}else alert(t.message)}))}else alert("주문번호가 정확하지 않습니다.")}$("tbody",i).hide(),i.on("click","table thead tr",(function(){$("tbody",i).hide(),$(".workCheck",i).text("");let t=$(this).closest("table");$(".workCheck",t).text("✔"),$("tbody",t).show()})),i.on("click",".btnAction",(function(){let t=$(this).closest("table").data("ROW");t.oswStatus;let e=$("template#outworkAction");o.openLayer(e.html(),o.workActionEvent,t)}))}else alert("작업지시서의 QR코드를 통하여 진입하시기 바랍니다.")})),o(this,"workActionEvent",((t,e)=>{const o=this,n=$(`#${t}`);let i="B",l="진행";$("input[name=oswActionCnt]",n).attr("placeholder","진행 시작 수량을 입력하십시요"),"B"==e.oswStatus&&(l="완료",i="D",$("input[name=oswActionCnt]",n).attr("placeholder","완료 수량을 입력하십시요")),$(".actionNm",n).text(l);let r=e.wNm;o._utils.checkEmptyNull(e.wInfo)||(r+="("+e.wInfo+")"),$(".wNm",n).text(r),n.on("click",".btnActionCall",(function(){let t=$("input[name=oswActionCnt]",n).val();if(o._utils.checkEmptyNull(t))return alert("수량을 입력하십시오"),!1;t=o._utils.getOnlyNumber(t);let l={ctl:"outsourcing",cmd:"statusUpdate",wSeq:e.wSeq,oswSeq:e.oswSeq,oswStatus:i};"D"==i?l.oswEndCnt=t:"B"==i&&(l.oswStartCnt=t),new s(o._const,l).ajaxformdata((function(t){0==t.code?o.modifyTime("work",(function(){document.location.reload()})):alert(t.message)}))}))})),o(this,"openLayer",((t,e,o,n)=>{const s=this;let i,l=s.createUniqueId(),r='<div class="mw_layer open"><div class="bg"></div><div id="'+l+'" class="ctlContainer">'+t+"</div></div>";$("body").append(r),i=$("#"+l+" div:eq(0)");let a=i.find(".mw_title");i.draggable({containment:"body",cursor:"move",handle:a}),s.initPositionLayer(i);let c=$(".contents");c.height(),null==c.attr("data-height")&&c.attr("data-height",c.height()),$("body").on("click",".btnClosePopLayer",(function(){let t=$("video");t.length>0&&s.stopScan(t[0]),s._scanner=!1,s.closeLayerPopup($(this))})),e(l,o,n)})),o(this,"closeLayerPopup",(t=>{if(null!=t){t.closest(".mw_layer").html("").remove();var e=$(".contents");null!=e.attr("data-height")&&e.css("minHeight",e.attr("data-height")+"px")}})),o(this,"createUniqueId",(()=>{const t=this;return t._uniqueID=t._uniqueID??0,"dynamicLayerID_"+ ++t._uniqueID})),o(this,"initPositionLayer",(t=>{let e=$(".wrap"),o=e.height(),n=e.width(),s=$(window).height(),i=$(window).width(),l=t.height(),r=t.width(),a=$(document).scrollTop(),c=$(document).scrollLeft();0==n&&(n=$(document).width()),0==o&&(o=$(document).width()),i<r&&(i=n),a+=(s-l)/2,c+=(i-r)/2,a<10&&(a=10),c<10&&(c=10),t.css("top",a),t.css("left",c),t.parent().prev(".bg").height("100%"),t.parent().prev(".bg").width("100%")})),o(this,"modifyTime",((t,e)=>{try{const o=this;let n={ctl:"media",cmd:"realLastTimeSave"};$.extend(n,t),new s(o._const,n,{wapi:"user/ws",spinner:!1}).ajaxformdata((function(t){0==t.code?"function"==typeof e&&e():toast("수정 시간 기록 실패")}))}catch(o){console.error(o.message)}})),o(this,"lastModifyTimeCheck",((t=[],e=self._utils.currentDateTime(),o=3,n,s)=>{let i=new Date(e.substring(0,4),parseInt(e.substring(4,6))-1,e.substring(6,8),e.substring(8,10),e.substring(10,12),e.substring(12));try{this.lastModifyTime((function(e){console.log(e);let l=!1;if("string"==typeof t){if(null!=e[t]){let s=e[t];new Date(s.substring(0,4),parseInt(s.substring(4,6))-1,s.substring(6,8),s.substring(8,10),s.substring(10,12),s.substring(12))-i>60*o*1e3&&(l=!0,"function"==typeof n&&n())}}else for(let s=0;s<t.length;s++)if(null!=e[t[s]]){let r=e[t[s]];if(new Date(r.substring(0,4),parseInt(r.substring(4,6))-1,r.substring(6,8),r.substring(8,10),r.substring(10,12),r.substring(12))-i>60*o*1e3){l=!0,"function"==typeof n&&n();break}}l||"function"==typeof s&&s()}))}catch(l){console.log(l.message)}})),this._const=t||{},this._data=e||{},this._param=i||{},this._options={},this._utils=new n,this._ajax=new s,this._employee={}}};class r{constructor(t,s,i){o(this,"init",(()=>{const t=this;switch(__ROUTE_PATH){case"workreport":t._workReportLogin=new e(t._const,t._data,t._param),t._workReportLogin.init();break;case"workreport/dashboard":t._workReportDashbaord=new l(t._const,t._data,t._param),t._workReportDashbaord.init()}})),this._const=t||{},this._data=s||{},this._param=i||{},this._options={},this._utils=new n}}window.addEventListener("orientationchange",(function(){setTimeout((function(){}),200)})),$((function(){const e={__ENVIRONMENT:"live",__URL_API:"https://api.dev.kprintfactory.com",__URL_AS3:"/assets/",__ISENCPARAM:!1,__ISDEBUGDATA:!1};let o,n;if(o=void 0!==t?t:self.exportGlobalModule={},__GLOBALINFO){let t=i.decrypt(__GLOBALINFO,"580v0xb7jtervnxjf3aki2i9hgzozg4g");if(t.islogin){let o=t.sessionInfo;$.extend(e,{__USER_ID:o.eSeq,__USER_NAME:o.eNm,__USER_TEL:o.eTel,__USER_LEVEL:o.authLevel,__GROUP_ID:o.cSeq,__ACCESSTOKEN:o.AccessToken,__ENCKEY:o.AuthKey,__MANAGER_YN:o.managerYn,__C_NM:o.cNm,__C_TEL:o.cTel,__C_ADDRESS:o.cAddr+" "+o.cAddrDetail})}}else $.extend(e,{__AUTH_API:"public",__ENCKEY:"580v0xb7jtervnxjf3aki2i9hgzozg4g"});n=__SEND_PARAMS?JSON.parse(__SEND_PARAMS):{};const s=new r(e,__SEND_PARAMS,n);s.init(),o.onControllerAction=function(t,e,o,n){return s.onControllerAction(t,e,o,n)}}))}},function(){return r||(0,l[e(l)[0]])((r={exports:{}}).exports,r),r.exports});export default a();
